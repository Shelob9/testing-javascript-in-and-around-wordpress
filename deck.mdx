import { Appear, Head, Image } from "mdx-deck";
import { FullScreenCode, Invert } from "mdx-deck/layouts";
import SyntaxHighlighter from "react-syntax-highlighter/prism";
import { atomLight, atomDark } from "react-syntax-highlighter/styles/prism";
export { dark as theme } from "mdx-deck/themes";

<Head>
  <title>Presentation Title</title>
  <meta property="og:description" content="Presentation description" />
  <meta property="og:site_name" content="Presentation Title" />
  <meta property="article:published_time" content="2013-09-17T05:59:00+01:00" />
  <meta property="article:modified_time" content="2013-09-16T19:08:47+01:00" />
  <meta property="article:section" content="Article Section (React? Design?)" />
</Head>

<Image
  src='https://images.unsplash.com/photo-1559369625-a3deda175816?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80'
  style={{
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    color: 'white',
    backgroundColor: 'black',
  }}>

# JavaScript Testing In And Aroung WordPress

</Image>

---

<Image
  src="https://pbs.twimg.com/profile_images/1044050165269766149/YyCvrqoN_400x400.jpg"
  style={{
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
    color: "white",
    backgroundColor: "black"
  }}
>
  <h2>Hi I'm Josh</h2>
  <ul>
    <li>
      <a href="https://JoshPress.net">JoshPress.net</a>
    </li>
    <li>
      <a href="https://Twitter.com/Josh412">@josh412</a>
    </li>
  </ul>
</Image>

---

## Types Of Tests

---

# Types Of Tests: Unit Tests

Does A Component Work In Isolation?

---

# Types Of Tests: Integration Tests

AKA - Feature Tests

Do The Components Work Together?

---

# Types Of Tests: Acceptance Tests

AKA - End to End Tests
AKA - e2e Tests

Does the whole system work together?

---

# JavaScript Testing In And Around WordPress

## Part One: Testing React Apps

---

# How React Works

---

## Step 1

React creates an object representation of nodes representing a user interface.

- It does not produce HTML.

---

## Step 2

A "renderer" converts that object to a useable interface.

- ReactDOM renders React as DOM tree and appended to DOM.
- ReactDOMServer renders to an HTML string for server to send to client.

---

# Test Renderers

- React Test Renderer
- React Testing Library
- Enzyme

---

# The Test Suite

- Test Runner (Jest)
  - Runs the tests
- Test Renderer (react-test-library)
  - Creates and inspects output
- Assertions (Chai)
  - Tests the output

---

# Zero-Config Testing (and more)

- react-scripts
  - `react-scripts test`
- @wordpress/scripts
  - `wordpress-scripts test`

---

`npx create-react-app`

# Let's Write Some Tests

And A Web App :)

---

# Questions To Ask?

- How do I know the components works?
  - Unit tests
- How do I know the components work together?
  - Integration/ Feature Tests
- What is the most realistic test of the program?
  - Acceptance/ e2e Tests

---

# App Spec

Create a one page app that:

- Displays a value
- Has an input to change that value

---

# Test Spec

- Unit tests:
  - Does display component display the supplied value?
  - Does edit callback display the value
  - Does the edit component supply updated value to onChange callback?

---

# Test Spec

- Integration Tests:
  - Does the display value change with the input?

---

# Layout Of Our Test File

---

## `test()` Syntax

```jsx
//Import React
import React from "react";
//Import test renderer
import TestRenderer from "react-test-renderer";
//Import component to test
import { DisplayValue } from "./DisplayValue";

test("Component renders value", () => {});

test("Component has supplied class name", () => {});
```

---

## BDD style

```jsx
//Import React
import React from "react";
//Import test renderer
import TestRenderer from "react-test-renderer";
//Import component to test
import { EditValue } from "./DisplayValue";

describe("EditValue component", () => {
  //Shared mock onChange function
  let onChange = jest.fn();
  beforeEach(() => {
    //Reset onChange mock before each test.
    onChange = jest.fn();
  });

  it("Has the supplied value in the input", () => {});

  it("id and for attribute match", () => {});

  it("Passes string to onChange when changed", () => {});

  it("Passes string to onChange when changed with an integer", () => {});
});
```

# Create A React App

<SyntaxHighlighter
  language="bash"
  style={atomLight}
  customStyle={{ minWidth: "500px" }}
>
  {`
# install create-react-app
npx create-react-app
# Run the included test
yarn test
  `}
</SyntaxHighlighter>

---

## Section

Create React App comes with one test.

This is an acceptance test. It tests if **anything** is broken.

<SyntaxHighlighter
  language="bash"
  style={atomLight}
  customStyle={{ minWidth: "500px" }}
>
  {`
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
it('renders without crashing', () => {
  const div = document.createElement('div');
  ReactDOM.render(<App />, div);
  ReactDOM.unmountComponentAtNode(div);
});
`}

</SyntaxHighlighter>
